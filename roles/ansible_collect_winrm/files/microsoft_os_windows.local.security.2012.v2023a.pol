id:microsoft_os_windows_2012.1.00001
checkname:C.1.1.1 - Password Policy - Enforce password history is set to '24 or more password(s)
severity:Critical
stanzaempty:Failed
type:multicheck
checks {
  rule1 {
    id:rule secedit
    checkname:IP.1.1.1 - Password Requirements - Enforce Password History from secedit
    stanzaempty:Failed
    severity:Critical
    type:alwayspassed
    segment:Windows_secedit_System_Access
    stanzastart:^(?!"MachineName")[^\;]*\;"PasswordHistorySize"
    stanzastop:$
    match:^(?:[^\;]*\;){2}"(\d+)
    criteria:min:24
  }
  rule2 {
    id:rule finegrainedpolicy
    checkname:IP.1.1.1 - Password Requirements - Enforce Password History from FGPP
    severity:Critical
    stanzaempty:Failed
    conditional:ifelse::match
    # Check for server domain role
    # Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
    segment:Windows_SystemInfo
    stanzastart:^(?!\"MachineName\")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:^(?:[^\;]*\;){21}\"\w+\sDomain\sController\"
    Conditions {
        if_passed {
            # Server is a Domain Controller
            stanzaempty:Failed
            severity:Critical
            type:matchvalue
            stanzaempty:Failed
            segment:Windows_fgpp
            stanzastart:^(?!"DomainName")[^\;]*\;
            stanzastop:$
            match:^(?:[^\;]*\;){9}"(\d+)
            criteria:min:24
            }
        if_failed {
            # Server is not domain controller therefore requirement not relevant
            type:notapplicable
        }
    }
  }
}

id:microsoft_os_windows_2012.1.00002
checkname:C.1.1.2 - Password Policy - Maximum Password Age
severity:Critical
stanzaempty:Failed
type:multicheck
checks {
  rule1 {
    id:rule secedit
    checkname:IP.1.1.2 - Password Requirements - Maximum Password Age from secedit
    stanzaempty:Failed
    severity:Critical
    type:alwayspassed
    segment:Windows_secedit_System_Access
    stanzastart:^(?!"MachineName")[^\;]*\;"MaximumPasswordAge"
    stanzastop:$
    match:^(?:[^\;]*\;){2}"(\d+)
    criteria:range:1-90
  }
  rule2 {
    id:rule finegrainedpolicy
    checkname:IP.1.1.2 - Password Requirements - Maximum Password Age from FGPP
    severity:Critical
    stanzaempty:Failed
    conditional:ifelse::match
    # Check for server domain role
    # Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
    segment:Windows_SystemInfo
    stanzastart:^(?!\"MachineName\")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:^(?:[^\;]*\;){21}\"\w+\sDomain\sController\"
    Conditions {
        if_passed {
            # Server is a Domain Controller
            stanzaempty:Failed
            severity:Critical
            type:matchvalue
            stanzaempty:Failed
            segment:Windows_fgpp
            stanzastart:^(?!"DomainName")[^\;]*\;
            stanzastop:$
            match:^(?:[^\;]*\;){6}"(\d+)
            criteria:range:1-90
            }
        if_failed {
            # Server is not domain controller therefore requirement not relevant
            type:notapplicable
        }
    }
  }
}

id:microsoft_os_windows_2012.1.00003
checkname:C.1.1.3 - Password Policy - Minimum Password Age
severity:Critical
stanzaempty:Failed
type:multicheck
checks {
  rule1 {
    id:rule secedit
    checkname:IP.1.1.3 - Password Requirements - Minimum Password Age from secedit
    stanzaempty:Failed
    severity:Critical
    type:matchvalue
    segment:Windows_secedit_System_Access
    stanzastart:^(?!"MachineName")[^\;]*\;"MinimumPasswordAge"
    stanzastop:$
    match:^(?:[^\;]*\;){2}"(\d+)
    criteria:min:1
  }
  rule2 {
    id:rule finegrainedpolicy
    checkname:IP.1.1.3 - Password Requirements - Minimum Password Age from FGPP
    severity:Critical
    stanzaempty:Failed
    conditional:ifelse::match
    # Check for server domain role
    # Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
    segment:Windows_SystemInfo
    stanzastart:^(?!\"MachineName\")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:^(?:[^\;]*\;){21}\"\w+\sDomain\sController\"
    Conditions {
        if_passed {
            # Server is a Domain Controller
            stanzaempty:Failed
            severity:Critical
            type:matchvalue
            stanzaempty:Failed
            segment:Windows_fgpp
            stanzastart:^(?!"DomainName")[^\;]*\;
            stanzastop:$
            match:^(?:[^\;]*\;){7}"(\d+)
            criteria:min:1
            }
        if_failed {
            # Server is not domain controller therefore requirement not relevant
            type:notapplicable
        }
    }
  }
}

id:microsoft_os_windows_2012.1.00004
checkname:C.1.1.4 - Password Policy - Minimum Password length
severity:Critical
stanzaempty:Failed
type:multicheck
checks {
  rule1 {
    id:rule secedit
    checkname:IP.1.1.4 - Password Requirements - Minimum Password length from secedit
    stanzaempty:Failed
    severity:Critical
    type:matchvalue
    segment:Windows_secedit_System_Access
    stanzastart:^(?!"MachineName")[^\;]*\;"MinimumPasswordLength"
    stanzastop:$
    match:^(?:[^\;]*\;){2}"(\d+)
    criteria: min:14
  }
  rule2 {
    id:rule finegrainedpolicy
    checkname:IP.1.1.4 - Password Requirements - Minimum Password length from FGPP
    severity:Critical
    stanzaempty:Failed
    conditional:ifelse::match
    # Check for server domain role
    # Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
    segment:Windows_SystemInfo
    stanzastart:^(?!\"MachineName\")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:^(?:[^\;]*\;){21}\"\w+\sDomain\sController\"
    Conditions {
        if_passed {
            # Server is a Domain Controller
            stanzaempty:Failed
            severity:Critical
            type:matchvalue
            stanzaempty:Failed
            segment:Windows_fgpp
            stanzastart:^(?!"DomainName")[^\;]*\;
            stanzastop:$
            match:^(?:[^\;]*\;){8}"(\d+)
            criteria:min:14
            }
        if_failed {
            # Server is not domain controller therefore requirement not relevant
            type:notapplicable
        }
    }
  }
}

id:microsoft_os_windows_2012.1.00005
checkname:C.1.1.5 - Password Policy - Password Complexity
severity:Critical
stanzaempty:Failed
type:multicheck
checks {
  rule1 {
    id:rule secedit
    checkname:IP.1.1.5 - Password Requirements - Password Must Meet Complexity Requirement from secedit
    stanzaempty:Failed
    severity:Critical
    type:alwayspassed
    segment:Windows_secedit_System_Access
    stanzastart:^(?!"MachineName")[^\;]*\;"PasswordComplexity"
    stanzastop:$
    match:^(?:[^\;]*\;){2}"(\d+)
    criteria:equal:1
  }
  rule2 {
    id:rule finegrainedpolicy
    checkname:IP.1.1.5 - Password Requirements - Password Must Meet Complexity Requirement from FGPP
    severity:Critical
    stanzaempty:Failed
    conditional:ifelse::match
    # Check for server domain role
    # Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
    segment:Windows_SystemInfo
    stanzastart:^(?!\"MachineName\")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:^(?:[^\;]*\;){21}\"\w+\sDomain\sController\"
    Conditions {
        if_passed {
            # Server is a Domain Controller
            stanzaempty:Failed
            severity:Critical
            type:alwayspassed
            stanzaempty:Failed
            segment:Windows_fgpp
            stanzastart:^(?!"DomainName")[^\;]*\;
            stanzastop:$
            stanzacriteria:include:^(?:[^\;]*\;){2}"True
            }
        if_failed {
            # Server is not domain controller therefore requirement not relevant
            type:alwayspassed
        }
    }
  }
}

id:microsoft_os_windows_2012.1.00006
checkname:C.1.1.7 - Password Policy - Store password using reversible encryption
severity:Critical
stanzaempty:Failed
type:multicheck
checks {
  rule1 {
    id:rule secedit
    checkname:IIP.1.1.6 - Password Requirements - Store password using reversible encryption from secedit
    stanzaempty:Failed
    severity:Critical
    type:matchvalue
    segment:Windows_secedit_System_Access
    stanzastart:^(?!"MachineName")[^\;]*\;"ClearTextPassword"
    stanzastop:$
    match:^(?:[^\;]*\;){2}"(\d+)
    criteria:equal:0
  }
  rule2 {
    id:rule finegrainedpolicy
    checkname:IP.1.1.6 - Password Requirements - Store password using reversible encryption from FGPP
    severity:Critical
    stanzaempty:Failed
    conditional:ifelse::match
    # Check for server domain role
    # Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
    segment:Windows_SystemInfo
    stanzastart:^(?!\"MachineName\")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:^(?:[^\;]*\;){21}\"\w+\sDomain\sController\"
    Conditions {
        if_passed {
            # Server is a Domain Controller
            stanzaempty:Failed
            severity:Critical
            type:match
            stanzaempty:Failed
            segment:Windows_fgpp
            stanzastart:^(?!"DomainName")[^\;]*\;
            stanzastop:$
            stanzacriteria:include:^(?:[^\;]*\;){10}"False
            }
        if_failed {
            # Server is not domain controller therefore requirement not relevant
            type:notapplicable
        }
    }
  }
}

id:microsoft_os_windows_2012.1.00007
checkname:C.1.2.1 - Password Policy - Account Lockout duration
severity:Critical
stanzaempty:Failed
type:multicheck
checks {
  rule1 {
    id:rule secedit
    checkname:IP.1.1.7 - Password Requirements - Account Lockout duration from secedit
    stanzaempty:Failed
    severity:Critical
    type: alwayspassed
    segment:Windows_secedit_System_Access
    stanzastart:^(?!"MachineName")[^\;]*\;"LockoutDuration"
    stanzastop:$
    match:^(?:[^\;]*\;){2}"(\d+)
    criteria:equal:15
  }
  rule2 {
    id:rule finegrainedpolicy
    checkname:IP.1.1.7 - Password Requirements - Account Lockout duration from FGPP
    severity:Critical
    stanzaempty:Failed
    conditional:ifelse::match
    # Check for server domain role
    # Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
    segment:Windows_SystemInfo
    stanzastart:^(?!\"MachineName\")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:^(?:[^\;]*\;){21}\"\w+\sDomain\sController\"
    Conditions {
        if_passed {
            # Server is a Domain Controller
            stanzaempty:Failed
            severity:Critical
            type:matchvalue
            segment:Windows_fgpp
            stanzastart:^(?!"DomainName")[^\;]*\;
            stanzastop:$
            match:^(?:[^\;]*\;){3}"00:(\d+):00"
            criteria:equal:15
            }
        if_failed {
            # Server is not domain controller therefore requirement not relevant
            type:notapplicable
        }
    }
  }
}

id:microsoft_os_windows_2012.1.00008
checkname:C.1.2.2 - Password Policy - Account Lockout Threshold
severity:Critical
stanzaempty:Failed
type:multicheck
checks {
  rule1 {
    id:rule secedit
    checkname:IP.1.1.8 - Password Requirements - Account Lockout Threshold from secedit
    stanzaempty:Failed
    severity:Critical
    type:matchvalue
    segment:Windows_secedit_System_Access
    stanzastart:^(?!"MachineName")[^\;]*\;"LockoutBadCount"
    stanzastop:$
    match:^(?:[^\;]*\;){2}"(\d+)
    criteria:equal:5
  }
  rule2 {
    id:rule finegrainedpolicy
    checkname:IP.1.1.8 - Password Requirements - Account Lockout Threshold from FGPP
    severity:Critical
    stanzaempty:Failed
    conditional:ifelse::match
    # Check for server domain role
    # Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
    segment:Windows_SystemInfo
    stanzastart:^(?!\"MachineName\")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:^(?:[^\;]*\;){21}\"\w+\sDomain\sController\"
    Conditions {
        if_passed {
            # Server is a Domain Controller
            stanzaempty:Failed
            severity:Critical
            type:matchvalue
            segment:Windows_fgpp
            stanzastart:^(?!"DomainName")[^\;]*\;
            stanzastop:$
            match:^(?:[^\;]*\;){5}"(\d+)
            criteria:equal:5
            }
        if_failed {
            # Server is not domain controller therefore requirement not relevant
            type:notapplicable
        }
    }
  }
}

id:microsoft_os_windows_2012.1.00009
checkname:C.1.2.3 - Reset account lockout counter after
severity:Critical
stanzaempty:Failed
type:multicheck
checks {
  rule1 {
    id:rule secedit
    checkname:IP.1.1.9 - Password Requirements - Reset account lockout counter after from secedit
    stanzaempty:Failed
    severity:Critical
    type:alwayspassed
    segment:Windows_secedit_System_Access
    stanzastart:^(?!"MachineName")[^\;]*\;"ResetLockoutCount"
    stanzastop:$
    match:^(?:[^\;]*\;){2}"(\d+)
    criteria:equal:15
  }
  rule2 {
    id:rule finegrainedpolicy
    checkname:IP.1.1.9 - Password Requirements - Reset account lockout counter after from FGPP
    severity:Critical
    stanzaempty:Failed
    conditional:ifelse::match
    # Check for server domain role
    # Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
    segment:Windows_SystemInfo
    stanzastart:^(?!\"MachineName\")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:^(?:[^\;]*\;){21}\"\w+\sDomain\sController\"
    Conditions {
        if_passed {
            # Server is a Domain Controller
            stanzaempty:Failed
            severity:Critical
            type:alwayspassed
            segment:Windows_fgpp
            stanzastart:^(?!"DomainName")[^\;]*\;
            stanzastop:$
            match:^(?:[^\;]*\;){4}"00:(\d+):00"
            criteria:equal:15
            }
        if_failed {
            # Server is not domain controller therefore requirement not relevant
            type:alwayspassed
        }
    }
  }
}

id:microsoft_os_windows_2012.1.00010
checkname:C.2.2.1 User Rights Assignment - Access Credential Manager as a trusted caller
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:exclude:(?im)^(?:[^\;]*\;)"SeTrustedCredManAccessPrivilege"

id:microsoft_os_windows_2012.1.00011
checkname:C.2.2.4 - Act as part of the operating system
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:exclude:(?im)^(?:[^\;]*\;)"SeTcbPrivilege"

id:microsoft_os_windows_2012.1.00012
checkname:C.2.2.6 - Adjust memory quotas for a process
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeIncreaseQuotaPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"(?=.*?(\*S-1-5-19,?))(?=.*?(\*S-1-5-20,?))(?=.*?(\*S-1-5-32-544,?))(?:(?:\1|\2|\3);?){3}"

id:microsoft_os_windows_2012.1.00013
checkname:C.2.2.7 - User Right Assignment - Allow log on locally
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeInteractiveLogonRight"
stanzastop:$
stanzacriteria: include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00014
checkname:C.2.2.10 - Back up files and directories
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeBackupPrivilege"
stanzastop:$
stanzacriteria: include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00015
checkname:C.2.2.11 - Change the system time
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeSystemtimePrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"(?=.*?(\*S-1-5-19,?))(?=.*?(\*S-1-5-32-544,?))(?:(?:\1|\2|);?){2}"

id:microsoft_os_windows_2012.1.00016
checkname:C.2.2.12 - Change the time zone
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeTimeZonePrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"(?=.*?(\*S-1-5-19,?))(?=.*?(\*S-1-5-32-544,?))(?:(?:\1|\2|);?){2}"

id:microsoft_os_windows_2012.1.00017
checkname:C.2.2.13 - Create a pagefile
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeCreatePagefilePrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00018
checkname:C.2.2.14 - Create a token object
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:exclude:(?im)^(?:[^\;]*\;)"SeCreateTokenPrivilege"

id:microsoft_os_windows_2012.1.00019
checkname:C.2.2.15 - Create global objects
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeCreateGlobalPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"(?=.*?(\*S-1-5-19,?))(?=.*?(\*S-1-5-6,?))(?=.*?(\*S-1-5-20,?))(?=.*?(\*S-1-5-32-544,?))(?:(?:\1|\2|\3|\4);?){4}"

id:microsoft_os_windows_2012.1.00020
checkname:C.2.2.16 - Create permanent shared objects
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:exclude:(?im)^(?:[^\;]*\;)"SeCreatePermanentPrivilege"

id:microsoft_os_windows_2012.1.00021
checkname:C.2.2.19 - User Right Assignment - Debug programs
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeDebugPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00022
checkname:C.3.3.22 - Deny log on as a batch job
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeDenyBatchLogonRight"
stanzastop:$
stanzacriteria: include:(?im)^(?:[^\;]*\;){2}"(?=.*(\*S-1-5-32-546))

id:microsoft_os_windows_2012.1.00023
checkname:C.2.2.23 - User Right Assignment - Deny log on as a service
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeDenyServiceLogonRight"
stanzastop:$
stanzacriteria: include:(?im)^(?:[^\;]*\;){2}"(?=.*(\*S-1-5-32-546))

id:microsoft_os_windows_2012.1.00024
checkname:C.2.2.24 - Deny log on locally
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeDenyInteractiveLogonRight"
stanzastop:$
stanzacriteria: include:(?im)^(?:[^\;]*\;){2}"(?=.*(\*S-1-5-32-546))

id:microsoft_os_windows_2012.1.00025
checkname:C.2.2.29 - User Right Assignment - Force shutdown from a remote system
severity:Critical
stanzaempty:Passed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeRemoteShutdownPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00026
checkname:C.2.2.30 - Generate security audits
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeAuditPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"(?=.*?(\*S-1-5-19,?))(?=.*?(\*S-1-5-20,?))(?:(?:\1|\2|);?){2}"

id:microsoft_os_windows_2012.1.00027
checkname:.C.2.2.33 - Increase scheduling priority
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeIncreaseBasePriorityPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"(\*S-1-5-32-544|\*S-1-5-90-0,\*S-1-5-32-544|\*S-1-5-32-544,\*S-1-5-90-0)"

id:microsoft_os_windows_2012.1.00028
checkname:C.2.2.34 - Load and unload device drivers
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeLoadDriverPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00029
checkname:C.2.2.35 - Lock pages in memory
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:exclude:(?im)^(?:[^\;]*\;)"SeLockMemoryPrivilege"

id:microsoft_os_windows_2012.1.00030
checkname:C.2.2.39 - Modify an object label
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:exclude:(?im)^(?:[^\;]*\;)"SeRelabelPrivilege"

id:microsoft_os_windows_2012.1.00031
checkname:C.2.2.40 - Modify firmware environment values
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeSystemEnvironmentPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00032
checkname:C.2.2.41 - Perform volume maintenance tasks
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeManageVolumePrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00033
checkname:C.2.2.42 - Profile single process
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeProfileSingleProcessPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00034
checkname:C.2.2.43 - Profile system performance
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeSystemProfilePrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"(?=.*?(\*S-1-5-32-544,?))(?=.*?(\*S-1-5-80-3139157870-2983391045-3678747466-658725712-1809340420,?))(?:(?:\1|\2|);?){2}"

id:microsoft_os_windows_2012.1.00035
checkname:C.2.2.45 - Restore files and directories
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeRestorePrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00036
checkname:C.2.2.46 - Shut down the system
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeShutdownPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00037
checkname:C.2.2.48 - Take ownership of files or other objects
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_secedit_Privilege_Rights
stanzastart:^(?!"MachineName")[^\;]*\;"SeTakeOwnershipPrivilege"
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"\*S-1-5-32-544"

id:microsoft_os_windows_2012.1.00038
checkname:C.2.3.1.2 - Accounts: Block Microsoft accounts
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:NoConnectedUser
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:3

id:microsoft_os_windows_2012.1.00039
checkname:C.2.3.1.4 - Accounts: Limit local account use of blank passwords to console logon only
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Lsa:LimitBlankPasswordUse
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00040
checkname:C.2.3.1.5 - Rename administrator account
severity:Critical
stanzaempty:Failed
type: alwayspassed
segment: Windows_Lcl_Users
stanzastart:^([^\;]*\;){6}(?=(?:"S-1-5-21-(?:\d+-){3}500))
stanzastop: $
stanzacriteria: include:(?im)^(?:[^\;]*\;){3}\"Kyndryl_Admin\";(?:[^\;]*\;){2}(?:"S-1-5-21-(?:\d+-){3}500)

id:microsoft_os_windows_2012.1.00041
checkname:C.2.3.1.6 - Rename guest account
severity:Critical
stanzaempty:Failed
type: alwayspassed
segment: Windows_Lcl_Users
stanzastart:^([^\;]*\;){6}(?=(?:"S-1-5-21-(?:\d+-){3}501))
stanzastop: $
stanzacriteria: include:(?im)^(?:[^\;]*\;){3}\"Kyndryl_Guest\";(?:[^\;]*\;){2}(?:"S-1-5-21-(?:\d+-){3}501)

id:microsoft_os_windows_2012.1.00042
checkname:C.2.3.2.1 - Audit: Force audit policy subcategory settings
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Lsa:SCENoApplyLegacyAuditPolicy
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"(1|registry\skey\snot\sfound)"

id:microsoft_os_windows_2012.1.00043
checkname:C.2.3.2.2 - Audit: Shut down system immediately if unable to log security audits
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Lsa:CrashOnAuditFail
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00044
checkname:C.2.3.4.1 - Devices: Allowed to format and eject removable media
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Winlogon:AllocateDASD
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00045
checkname:C.2.3.4.2 - Devices: Prevent users from installing printer drivers
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Servers:AddPrinterDrivers
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00046
checkname:C.2.3.6.1 - Domain member: Digitally encrypt or sign secure channel data (always)
severity:Critical
stanzaempty:Failed
conditional:ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment:Windows_SystemInfo
stanzastart:^(?!\"MachineName\")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){21}(?:\"Member\s\w+")
Conditions {
    if_passed {
        # Server is a domain member therefore key must exist with specific value
        stanzaempty:Failed
        type:matchvalue
        segment:Windows_Reg_Parameters:RequireSignOrSeal
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){2}"(\d+)"
        criteria:equal:1
    }
    if_failed {
        # Server is a domain controller therefore requirement not relevant
        type:notapplicable
    }
}

id:microsoft_os_windows_2012.1.00047
checkname:C.2.3.6.2 - Domain member: Digitally encrypt secure channel data (when possible)
severity:Critical
stanzaempty:Failed
conditional:ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment:Windows_SystemInfo
stanzastart:^(?!\"MachineName\")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){21}(?:\"Member\s\w+")
Conditions {
    if_passed {
        # Server is a domain member therefore key must exist with specific value
        stanzaempty:Failed
        type:matchvalue
        segment:Windows_Reg_Parameters:SealSecureChannel
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){2}"(\d+)"
        criteria:equal:1
    }
    if_failed {
        # Server is a domain controller therefore requirement not relevant
        type:notapplicable
    }
}

id:microsoft_os_windows_2012.1.00048
checkname:C.2.3.6.3 - Domain member: Digitally sign secure channel data (when possible)
severity:Critical
stanzaempty:Failed
conditional:ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment:Windows_SystemInfo
stanzastart:^(?!\"MachineName\")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){21}(?:\"Member\s\w+")
Conditions {
    if_passed {
        # Server is a domain member therefore key must exist with specific value
        stanzaempty:Failed
        type:matchvalue
        segment:Windows_Reg_Parameters:SignSecureChannel
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){2}"(\d+)"
        criteria:equal:1
    }
    if_failed {
        # Server is a domain controller therefore requirement not relevant
        type:notapplicable
    }
}

id:microsoft_os_windows_2012.1.00049
checkname:C.2.3.6.4 - Domain member: Disable machine account password changes
severity:Critical
stanzaempty:Failed
conditional:ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment:Windows_SystemInfo
stanzastart:^(?!\"MachineName\")[^\;]*\;
stanzastop:$
stanzacriteria: include:^(?:[^\;]*\;){21}\"Member\sServer\"
Conditions {
    if_passed {
        # Server is member server therefore key must exist with specific value
        stanzaempty:Failed
        type:matchvalue
        segment:Windows_Reg_Parameters:DisablePasswordChange
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){2}"(\d+)"
        criteria:equal:0
    }
    if_failed {
        # Server is a domain controller therefore requirement not relevant
        type:notapplicable
    }
}

id:microsoft_os_windows_2012.1.00050
checkname:C.2.3.6.5 - Domain member: Maximum machine account password age
severity:Critical
stanzaempty:Failed
conditional:ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment:Windows_SystemInfo
stanzastart:^(?!\"MachineName\")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){21}(?:\"Member\s\w+")
Conditions {
    if_passed {
        # Server is a domain member therefore key must exist with specific value
        stanzaempty:Failed
        type:matchvalue
        segment:Windows_Reg_Parameters:MaximumPasswordAge
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){2}"(\d+)"
        criteria:range:1-30
    }
    if_failed {
        # Server is a domain controller therefore requirement not relevant
        type:notapplicable
    }
}

id:microsoft_os_windows_2012.1.00051
checkname:C.2.3.6.6 - Domain member: Require strong (Windows 2000 or later) session key
severity:Critical
stanzaempty:Failed
conditional:ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment:Windows_SystemInfo
stanzastart:^(?!\"MachineName\")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){21}(?:\"Member\s\w+")
Conditions {
    if_passed {
        # Server is a domain member therefore key must exist with specific value
        stanzaempty:Failed
        type:matchvalue
        segment:Windows_Reg_Parameters:RequireStrongKey
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){2}"(\d+)"
        criteria:equal:1
    }
    if_failed {
        # Server is a domain controller therefore requirement not relevant
        type:notapplicable
    }
}

id:microsoft_os_windows_2012.1.00052
checkname:C.2.3.7.1 - Interactive logon: Don't display last signed-in
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:dontdisplaylastusername
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00053
checkname:C.2.3.7.2 - Interactive logon: Do not require CTRL+ALT+DEL
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:disablecad
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00054
checkname:C.2.3.7.3 - Interactive logon: Machine inactivity limit
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:InactivityTimeoutSecs
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:range:1-900

id:microsoft_os_windows_2012.1.00055
checkname:C.2.3.7.4 - Interactive logon: Message text for users attempting to log on
severity:Critical
stanzaempty:Failed
type: match
segment:Windows_Reg_System:legalNoticeText
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria: include:(?im)^(?:[^\;]*\;){2}".*?Business\sUse\sNotice.*?"

id:microsoft_os_windows_2012.1.00056
checkname:C.2.3.7.5 - Interactive logon: Message title for users attempting to log on
severity:Critical
stanzaempty:Failed
type: match
segment:Windows_Reg_System:legalnoticecaption
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria: include:(?im)^(?:[^\;]*\;){2}".*?Business\sUse\sNotice.*?"

id:microsoft_os_windows_2012.1.00057
checkname:C.2.3.7.7 - Interactive logon: Prompt user to change password before expiration
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Winlogon:PasswordExpiryWarning
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:range:5-14

id:microsoft_os_windows_2012.1.00058
checkname:C.2.3.7.9 - Interactive logon: Smart card removal behavior
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Winlogon:SCRemoveOption
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:range:1-3

id:microsoft_os_windows_2012.1.00059
checkname:C.2.3.8.1 - Microsoft network client: Digitally sign communications (always)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_LanManW:RequireSecuritySignature
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00060
checkname:C.2.3.8.2 - Microsoft network client: Digitally sign communications (if server agrees)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_LanManW:EnableSecuritySignature
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00061
checkname:C.2.3.8.3 - Microsoft network client: Send unencrypted password to third-party SMB servers
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_LanManW:EnablePlainTextPassword
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00062
checkname:C.2.3.9.1 - Microsoft network server: Amount of idle time required before suspending session
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Parameters:AutoDisconnect
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:range:0-15

id:microsoft_os_windows_2012.1.00063
checkname:C.2.3.9.2 - Microsoft network server: Digitally sign communications (always)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_LanManS:RequireSecuritySignature
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00064
checkname:C.2.3.9.3 - Microsoft network server: Digitally sign communications (always)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_LanManS:RequireSecuritySignature
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00065
checkname:C.2.3.9.4 - Microsoft network server: Disconnect clients when logon hours expire
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Parameters:enableforcedlogoff
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00066
checkname:C.2.3.10.1 - Allow anonymous SID/Name translation
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Lsa:TurnOffAnonymousBlock
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00067
checkname:C.2.3.10.4 - Do not allow storage of passwords and credentials for network authentication' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_Parameters:NullSessionShares
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}""
discard:registry\skey\snot\sfound

id:microsoft_os_windows_2012.1.00068
checkname:C.2.3.10.5 - Network access: Let Everyone permissions apply to anonymous users
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Lsa:EveryoneIncludesAnonymous
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00069
checkname:C.2.3.10.8 - Network access: Remotely accessible registry paths
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_AllowedExactPaths:Machine
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"System\\CurrentControlSet\\Control\\(ProductOptions|Server\sApplications)|Software\\Microsoft\\Windows\sNT\\CurrentVersion"

id:microsoft_os_windows_2012.1.00070
checkname:C.2.3.10.9 - Remotely accessible registry paths and sub-paths
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_AllowedPaths:Machine
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"Software\\Microsoft\\OLAP\sServer"|Software\\Microsoft\\Windows\sNT\\CurrentVersion\\Perflib"|Software\\Microsoft\\Windows\sNT\\CurrentVersion\\Print"|Software\\Microsoft\\Windows\sNT\\CurrentVersion\\Windows"|System\\CurrentControlSet\\Control\\ContentIndex"|System\\CurrentControlSet\\Control\\Print\\Printers"|System\\CurrentControlSet\\Control\\Terminal\sServer"|System\\CurrentControlSet\\Control\\Terminal\sServer\\DefaultUserConfiguration"|System\\CurrentControlSet\\Control\\Terminal\sServer\\UserConfig"|System\\CurrentControlSet\\Services\\Eventlog"|System\\CurrentControlSet\\Services\\SysmonLog"|System\\CurrentControlSet\\Services\\CertSvc"|System\\CurrentControlSet\\Services\\WINS"

id:microsoft_os_windows_2012.1.00071
checkname:C.2.3.10.12 - Shares that can be accessed anonymously
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_Parameters:NullSessionShares
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:(?im)^(?:[^\;]*\;){2}""
discard:registry\skey\snot\sfound

id:microsoft_os_windows_2012.1.00072
checkname:C.2.3.10.13 - Sharing and security model for local accounts
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Lsa:ForceGuest
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00073
checkname:C.2.3.11.1 - Allow Local System to use computer identity for NTLM
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Lsa:UseMachineId
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00074
checkname:C.2.3.11.2 - Network security: Allow LocalSystem NULL session fallback
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_MSV1_0:AllowNullSessionFallback
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00075
checkname:C.2.3.11.3 - Network Security: Allow PKU2U authentication requests to this computer to use online identities
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_pku2u:AllowOnlineID
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00076
checkname:C.2.3.11.4 - Network security: Configure encryption types allowed for Kerberos
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Parameters:SupportedEncryptionTypes
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:2147483640

id:microsoft_os_windows_2012.1.00077
checkname:C.2.3.11.5 - Network security: Do not store LAN Manager hash value on next password change
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Lsa:NoLMHash
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00078
checkname:C.2.3.11.6 - Network security: Force logoff when logon hours expire
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_secedit_System_Access
stanzastart:^(?!"MachineName")[^\;]*\;"ForceLogoffWhenHourExpire"
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00079
checkname:C.2.3.11.7 - Network security: LAN Manager authentication level
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Lsa:LmCompatibilityLevel
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:5

id:microsoft_os_windows_2012.1.00080
checkname:C.2.3.11.8 - Network security: LDAP client signing requirements
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_LDAP:LDAPClientIntegrity
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00081
checkname:C.2.3.11.9 - Minimum session security for NTLM SSP based (including secure RPC) clients.
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_MSV1_0:NTLMMinClientSec
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:537395200

id:microsoft_os_windows_2012.1.00082
checkname:C.2.3.11.10 - Minimum session security for NTLM SSP based (including secure RPC) servers
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_MSV1_0:NTLMMinServerSec
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:537395200

id:microsoft_os_windows_2012.1.00083
checkname:C.2.3.13.1 - Shutdown: Allow system to be shut down without having to log on
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:ShutdownWithoutLogon
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00084
checkname:C.2.3.15.1 - Require case insensitivity for non-Windows subsystems
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_SM_Kernel:ObCaseInsensitive
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00085
checkname:C.2.3.15.2 - Strengthen default permissions of internal system objects (e.g. Symbolic Links)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_SM:ProtectionMode
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00086
checkname:C.2.3.17.1 - User Account Control: Admin Approval Mode for the Built-in Administrator account
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:FilterAdministratorToken
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00087
checkname:C.2.3.17.2 - User Account Control: Behavior of the elevation prompt for administrators
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:ConsentPromptBehaviorAdmin
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:range:1-2

id:microsoft_os_windows_2012.1.00088
checkname:C.2.3.17.3 - User Account Control: Behavior of the elevation prompt for standard users
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_System:ConsentPromptBehaviorUser
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00089
checkname:C.2.3.17.4 - Detect application installations and prompt for elevation
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:EnableInstallerDetection
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00090
checkname:C.2.3.17.5 - Only elevate UIAccess applications that are installed in secure locations
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:EnableSecureUIAPaths
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00091
checkname:C.2.3.17.6 - Run all administrators in Admin Approval Mode
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:EnableLUA
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00092
checkname:C.2.3.17.7 - Switch to the secure desktop when prompting for elevation
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:PromptOnSecureDesktop
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00093
checkname:C.2.3.17.8 - Virtualize file and registry write failures to per-user locations
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:EnableVirtualization
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00094
checkname:C.9.1.1 - Windows Firewall: Domain: Firewall state
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWDomain:EnableFirewall
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00095
checkname:C.9.1.2 - Windows Firewall: Domain: Inbound connections
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_FWDomain:DefaultInboundAction
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00096
checkname:C.9.1.3 - Windows Firewall: Domain: Outbound connections
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWDomain:DefaultOutboundAction
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00097
checkname:C.9.1.4 - Windows Firewall: Domain: Settings: Display a notification
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_FWDomain:DisableNotifications
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00098
checkname:C.9.1.5 - Windows Firewall: Domain: Logging: Name
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWDomain:LogFilePath
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:(?i)^(?:[^\;]*\;){2}"%SystemRoot%\\System32\\logfiles\\firewall\\domainfw\.log"

id:microsoft_os_windows_2012.1.00099
checkname:C.9.1.6 - Windows Firewall: Domain: Logging: Size limit (KB)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_FWDomain:LogFileSize
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:min:16384

id:microsoft_os_windows_2012.1.00100
checkname:C.9.1.7 - Windows Firewall: Domain: Logging: Log dropped packets
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_FWDomain:LogDroppedPackets
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00101
checkname:C.9.1.8 - Windows Firewall: Domain: Logging: Log successful connections
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_FWPublic:LogSuccessfulConnections
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00102
checkname:C.9.2.1 - Windows Firewall: Private: Firewall state
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_FWPrivate:EnableFirewall
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00104
checkname:C.9.2.2 - Windows Firewall: Private: Inbound connections
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWPrivate:DefaultInboundAction
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00105
checkname:C.9.2.3 - Windows Firewall: Private: Outbound connections
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWPrivate:DefaultOutboundAction
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00106
checkname:C.9.2.4 - Windows Firewall: Private: Settings: Display a notification
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_FWPrivate:DisableNotifications
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00107
checkname:C.9.2.5 - Windows Firewall: Private: Logging: Name
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWPrivate:LogFilePath
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:(?i)^(?:[^\;]*\;){2}"%SystemRoot%\\System32\\logfiles\\firewall\\privatefw\.log"

id:microsoft_os_windows_2012.1.00108
checkname:C.9.2.6 - Windows Firewall: Private: Logging: Size limit (KB)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_FWPrivate:LogFileSize
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:min:16384

id:microsoft_os_windows_2012.1.00109
checkname:C.9.2.7 - Windows Firewall: Private: Logging: Log dropped packets
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_FWPrivate:LogDroppedPackets
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00110
checkname:C.9.2.8 - Windows Firewall: Private: Logging: Log successful connections
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_FWPrivate:LogSuccessfulConnections
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00111
checkname:C.9.3.1 - Windows Firewall: Public: Firewall state
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_FWPublic:EnableFirewall
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00112
checkname:C.9.3.2 - Windows Firewall: Public: Inbound connections
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWPublic:DefaultInboundAction
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00113
checkname:C.9.3.3 - Windows Firewall: Public: Outbound connections
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWPublic:DefaultOutboundAction
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00114
checkname:C.9.3.4 - Windows Firewall: Public: Settings: Display a notification
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWPublic:DisableNotifications
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00115
checkname:C.9.3.5 - Windows Firewall: Public: Settings: Apply local firewall rules
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWPublic:AllowLocalPolicyMerge
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00116
checkname:C.9.3.6 - Windows Firewall: Public: Settings: Apply local connection security rules
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWPublic:AllowLocalIPsecPolicyMerge
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00117
checkname:C.9.3.7 - Windows Firewall: Public: Logging: Name
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_FWPublic:LogFilePath
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:(?i)^(?:[^\;]*\;){2}"%SystemRoot%\\System32\\logfiles\\firewall\\publicfw\.log"

id:microsoft_os_windows_2012.1.00118
checkname:C.9.3.8 - Windows Firewall: Public: Logging: Size limit (KB)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_FWPublic:LogFileSize
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:min:16384

id:microsoft_os_windows_2012.1.00119
checkname:C.9.3.9 - Windows Firewall: Public: Logging: Log dropped packets
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_FWPublic:LogDroppedPackets
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00120
checkname:C.9.3.10 - Windows Firewall: Public: Logging: Log successful connections
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_FWPublic:LogSuccessfulConnections
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00121
checkname:C.17.1.1 - Audit Credential Validation
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Credential Validation\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00122
checkname:C.17.2.1 - Audit Application Group Management
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Application Group Management\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00123
checkname:C.17.2.5 - Audit Security Group Management
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Security Group Management\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success\"

id:microsoft_os_windows_2012.1.00124
checkname:C.17.2.6 - Audit User Account Management
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"User Account Management\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00125
checkname:C.17.3.1 - Audit User Account Management
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"User Account Management\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00126
checkname:C.17.5.1 - Audit Account Lockout
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Account Lockout\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Failure\"

id:microsoft_os_windows_2012.1.00127
checkname:C.17.5.2 - Audit Logoff
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Logoff\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success\"

id:microsoft_os_windows_2012.1.00128
checkname:C.17.5.3 - Audit Logon
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Logon\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00129
checkname:C.17.5.4 - Audit Other Logon/Logoff Events
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Other Logon/Logoff Events\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00130
checkname:C.17.5.5 - Audit Special Logon
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Special Logon\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success\"

id:microsoft_os_windows_2012.1.00131
checkname:C.17.6.1 - Audit Detailed File Share
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Detailed File Share\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Failure\"

id:microsoft_os_windows_2012.1.00132
checkname:C.17.6.2 - Audit File Share
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"File Share\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00133
checkname:C.17.6.3 - Audit Other Object Access Events
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Other Object Access Events\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00134
checkname:C.17.6.4 - Audit Removable Storage
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Removable Storage\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00135
checkname:C.17.7.1 - Audit Policy Change
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Audit Policy Change\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success\"

id:microsoft_os_windows_2012.1.00136
checkname:C.17.7.2 - Audit Authentication Policy Change
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Authentication Policy Change\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success\"

id:microsoft_os_windows_2012.1.00137
checkname:C.17.7.3 - Audit Authorization Policy Change
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Authorization Policy Change\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success\"

id:microsoft_os_windows_2012.1.00138
checkname:C.17.7.4 - Audit MPSSVC Rule-Level Policy Change
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"MPSSVC Rule-Level Policy Change\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00139
checkname:C.17.7.5 - Audit Other Policy Change Events
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Other Policy Change Events\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Failure\"

id:microsoft_os_windows_2012.1.00140
checkname:C.17.8.1 - Audit Sensitive Privilege Use
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Sensitive Privilege Use\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00141
checkname:C.17.9.1 - Audit IPsec Driver
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"IPsec Driver\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00142
checkname:C.17.9.2 - Audit Other System Events
severity:Critical
stanzaempty:Failed
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Other System Events\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00143
checkname:C.17.9.3 - Audit Security State Change
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Security State Change\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success\"

id:microsoft_os_windows_2012.1.00144
checkname:C.17.9.4 - Audit Security System Extension
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"Security System Extension\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success\"

id:microsoft_os_windows_2012.1.00145
checkname:C.17.9.5 - Audit System Integrity
severity:Critical
stanzaempty:Failed
segment: Windows_auditpol
type: match
stanzastart:^(?!\"MachineName\")(?:[^\;]*\;)\"System Integrity\"
stanzastop: $
stanzacriteria:include:^(?:[^\;]*\;){2}\"Success and Failure\"

id:microsoft_os_windows_2012.1.00146
checkname:C.18.1.1.1 - Prevent enabling lock screen camera
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Pers:NoLockScreenCamera
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00147
checkname:C.18.1.1.2 - Prevent enabling lock screen slide show
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Pers:NoLockScreenSlideshow
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00148
checkname:C.18.3.2 - Configure SMB v1 client driver
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_mrxsmb10:Start
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:4

id:microsoft_os_windows_2012.1.00149
checkname:C.18.3.3 - Configure SMB v1 server
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_LanManS:SMB1
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00150
checkname:C.18.3.4 - Enable Structured Exception Handling Overwrite Protection (SEHOP)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_kernel:DisableExceptionChainValidation
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00151
checkname:C.18.3.5 - Printers - Limits print driver installation to Administrators
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_PointAndPrint:RestrictDriverInstallationToAdministrators
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00152
checkname:C.18.3.6 - NetBT NodeType configuration
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_NetBT:NodeType
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:2

id:microsoft_os_windows_2012.1.00153
checkname:C.18.3.7 - WDigest Authentication
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_WDigest:UseLogonCredential
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00154
checkname:C.18.4.1 - MSS: (AutoAdminLogon) Enable Automatic Logon (not recommended)
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Winlogon:AutoAdminLogon
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00155
checkname:C.18.4.2 - MSS: (DisableIPSourceRouting IPv6) IP source routing protection level (protects against packet spoofing)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Tcpip6:DisableIPSourceRouting
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:2

id:microsoft_os_windows_2012.1.00156
checkname:C.18.4.3 - MSS: (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Tcpip:DisableIPSourceRouting
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:2

id:microsoft_os_windows_2012.1.00157
checkname:C.18.4.4 - MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Tcpip:EnableICMPRedirect
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00158
checkname:C.18.4.6 - MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_NetBT:NoNameReleaseOnDemand
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00159
checkname:C.18.4.8 - MSS: (SafeDllSearchMode) Enable Safe DLL search mode (recommended)
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_SM:SafeDllSearchMode
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00160
checkname:C.18.4.9 - MSS: (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Winlogon:ScreenSaverGracePeriod
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:range:0-5

id:microsoft_os_windows_2012.1.00161
checkname:C.18.4.12 - MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Evnt_Security:WarningLevel
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:range:50-90

id:microsoft_os_windows_2012.1.00162
checkname:C.18.5.4.1 - Configure DNS over HTTPS (DoH) name resolution' is set to 'Enabled: Allow DoH
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_DNSClient:DoHPolicy
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:2

id:microsoft_os_windows_2012.1.00163
checkname:C.18.5.4.2 - Turn off multicast name resolution
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_DNSClient:EnableMulticast
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00164
checkname:C.18.5.9.1 - Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Tcpip:EnableICMPRedirect
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00165
checkname:C.18.5.9.2 - Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_DNSClient:EnableMulticast
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00166
checkname:C.18.5.10.2 - Ensure 'Turn off Microsoft Peer-to-Peer Networking Services' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_DNSClient:DoHPolicy
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:2

id:microsoft_os_windows_2012.1.00167
checkname:C.18.5.11.2 - Prohibit installation and configuration of Network Bridge on your DNS domain network
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_NC:NC_AllowNetBridge_NLA
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00168
checkname:C.18.5.11.3 - Require domain users to elevate when setting a network's location
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_NC:NC_StdDomainUserSetLocation
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00169
checkname:C.18.5.14.1 - Hardened UNC Paths' is set to 'Enabled, with "Require Mutual Authentication
severity:Critical
stanzaempty:Failed
type:multicheck
checks {
  check1 {
    id:NETLOGON hardening
    checkname:IP.C.5.9.1 - Administrative Templates (Computer) - Network - Network Provider - Hardened UNC Paths - NETLOGON
    severity:Critical
    stanzaempty:Failed
    type:match
    segment:Windows_Reg_HardenedPaths:\\*\NETLOGON
    stanzastart:^(?!"MachineName")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"(?=.*RequireMutualAuthentication=1)(?=.*RequireIntegrity=1).*
  }
  check2 {
    id:SYSVOL hardening
    checkname:IP.C.5.9.1 - Administrative Templates (Computer) - Network - Network Provider - Hardened UNC Paths - SYSVOL
    severity:Critical
    stanzaempty:Failed
    type:match
    segment:Windows_Reg_HardenedPaths:\\*\SYSVOL
    stanzastart:^(?!"MachineName")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"(?=.*RequireMutualAuthentication=1)(?=.*RequireIntegrity=1).*
  }
}

id:microsoft_os_windows_2012.1.00170
checkname:C.18.5.19.2.1 - Disable IPv6 (Ensure TCPIP6 Parameter 'DisabledComponents' is set to '0xff (255)')...
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_HardenedPaths:\\*\NETLOGON
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:exclude:.*

id:microsoft_os_windows_2012.1.00171
checkname:C.18.5.20.1 - Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'...
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_HardenedPaths:\\*\NETLOGON
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:exclude:.*

id:microsoft_os_windows_2012.1.00172
checkname:C.18.5.20.2 - Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_PointAndPrint:NoWarningNoElevationOnInstall
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00173
checkname:C.18.5.21.1 - Minimize the number of simultaneous connections to the Internet or a Windows Domain
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_GroupPolicy:fMinimizeConnections
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:3

id:microsoft_os_windows_2012.1.00174
checkname:C.18.6.1 - Allow Print Spooler to accept client connections
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Printers:RegisterSpoolerRemoteRpcEndPoint
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:2

id:microsoft_os_windows_2012.1.00175
checkname:C.18.6.2 - Printers - Point and Print Restrictions: When installing drivers for a new connection
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_PointAndPrint:NoWarningNoElevationOnInstall
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00176
checkname:C.18.6.3 - Printers - Point and Print Restrictions: When updating drivers for an existing connection
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_PointAndPrint:UpdatePromptSettings
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00177
checkname:C.18.7.1 - Ensure 'Turn off notifications network usage' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_PointAndPrint:NoWarningNoElevationOnInstall
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00178
checkname:C.18.8.3.1 - Audit Process Creation - Include command line in process creation
severity:Critical
stanzaempty:Failed
type:matchvalue
segment: Windows_Reg_Audit:ProcessCreationIncludeCmdLine_Enabled
stanzastart:^(?!"MachineName")(?:[^\;]*\;)
stanzastop:$
match:^(?:[^\;]*\;){2}\"(\d+)\"
criteria: equal:1

id:microsoft_os_windows_2012.1.00179
checkname:C.18.4.1 - Encryption Oracle Remediation
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Parameters:AllowEncryptionOracle
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00180
checkname:C.18.7.2 - Prevent device metadata retrieval from the Internet
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_DeviceMetadata:PreventDeviceMetadataFromNetwork
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00181
checkname:C.18.8.14.1 - Boot-Start Driver Initialization Policy
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_EarlyLaunch:DriverLoadPolicy
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:3

id:microsoft_os_windows_2012.1.00182
checkname:C.18.8.21.2 - Ensure 'Configure registry policy processing: Do not apply during periodic background processing' is set to 'Enabled: FALSE'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_PointAndPrint:NoWarningNoElevationOnInstall
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00183
checkname:C.18.8.21.3 - Ensure 'Configure registry policy processing: Process even if the Group Policy objects have not changed' is set to 'Enabled: TRUE'...
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_System:DisableBkGndGroupPolicy
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}\"registry\skey\snot\sfound\"

id:microsoft_os_windows_2012.1.00184
checkname:C.18.8.21.4 - Turn off background refresh of Group Policy
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_System:DisableBkGndGroupPolicy
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}\"registry\skey\snot\sfound\"

id:microsoft_os_windows_2012.1.00185
checkname:C.18.8.22.1.1 - Turn off downloading of print drivers over HTTP
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Printers:DisableWebPnPDownload
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00186
checkname:C.18.8.22.1.2 - Ensure 'Turn off handwriting personalization data sharing' is set to 'Enabled'...
severity:medium
stanzaempty:Failed
type:match
segment:Windows_Reg_HardenedPaths:\\*\SYSVOL
stanzastart:^(?!\"Devicename\")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}\"registry\skey\snot\sfound\"

id:microsoft_os_windows_2012.1.00187
checkname:C.18.8.22.1.3 - Ensure 'Turn off handwriting recognition error reporting' is set to 'Enabled'...
severity:medium
stanzaempty:Failed
type:match
segment:Windows_Reg_HardenedPaths:\\*\SYSVOL
stanzastart:^(?!\"Devicename\")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}\"registry\skey\snot\sfound\"

id:microsoft_os_windows_2012.1.00188
checkname:C.18.8.22.1.4 - Ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled'...
severity:medium
stanzaempty:Failed
type:match
segment:Windows_Reg_HardenedPaths:\\*\SYSVOL
stanzastart:^(?!\"Devicename\")[^\;]*\;
stanzastop:$
stanzacriteria:include:1

id:microsoft_os_windows_2012.1.00189
checkname:C.18.8.22.1.5 - Turn off Internet download for Web publishing and online ordering wizards
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoWebServices
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00190
checkname:C.18.8.22.1.6 - Ensure 'Turn off printing over HTTP' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoWebServices
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00191
checkname:C.18.8.22.1.7 - Ensure 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoWebServices
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:128

id:microsoft_os_windows_2012.1.00192
checkname:C.18.8.22.1.8 - Ensure 'Turn off Search Companion content file updates' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoWebServices
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00193
checkname:C.18.8.22.1.9 - Ensure 'Turn off the "Order Prints" picture task' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoWebServices
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00194
checkname:C.18.8.22.1.10 - Ensure 'Turn off the "Publish to Web" task for files and folders' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoWebServices
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:2

id:microsoft_os_windows_2012.1.00195
checkname:C.18.8.22.1.11 - Ensure 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoWebServices
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00196
checkname:C.18.8.22.1.12 - Ensure 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoWebServices
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:6

id:microsoft_os_windows_2012.1.00197
checkname:C.18.8.22.1.13 - Ensure 'Turn off Windows Error Reporting' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoWebServices
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00198
checkname:C.18.8.27.1 - Ensure 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled'...
severity:medium
stanzaempty:Failed
type:match
segment:Windows_Reg_Explorer:NoWebServices
stanzastart:^(?!\"Devicename\")[^\;]*\;
stanzastop:$
stanzacriteria:exclude:.*

id:microsoft_os_windows_2012.1.00199
checkname:C.18.8.28.1 - Do not display network selection UI
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:DontDisplayNetworkSelectionUI
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00200
checkname:C.18.8.28.2 - Do not enumerate connected users on domain-joined computers
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:DontEnumerateConnectedUsers
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00201
checkname:C.18.8.28.4 - Turn off app notifications on the lock screen
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:DisableLockScreenAppNotifications
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00202
checkname:C.18.8.28.5 - Turn off picture password sign-in
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:BlockDomainPicturePassword
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00203
checkname:C.18.8.28.6 - Turn on convenience PIN sign-in
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_System:AllowDomainPINLogon
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00204
checkname:C.18.8.34.6.1 - Require a password when a computer wakes (on battery)
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Power:DCSettingIndex
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00205
checkname:C.18.8.34.6.2 - Require a password when a computer wakes (plugged in)
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Power:ACSettingIndex
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00206
checkname:C.18.8.36.1 - Configure Offer Remote Assistance
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_TS:fAllowUnsolicited
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00207
checkname:C.18.8.36.2 - Configure Solicited Remote Assistance
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_TS:fAllowToGetHelp
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00208
checkname:C.18.8.48.5.1 - Ensure 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is set to 'Disabled'...
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_TS:fAllowUnsolicited
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00209
checkname:C.18.8.48.11.1 - Ensure 'Enable/Disable PerfTrack' is set to 'Disabled'...
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_TS:fAllowUnsolicited
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:1

id:microsoft_os_windows_2012.1.00210
checkname:C.18.8.50.1 - Ensure 'Turn off the advertising ID' is set to 'Enabled'...
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_TS:fAllowUnsolicited
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:exclude:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00211
checkname:C.18.8.53.1.1 - Enable Windows NTP Server
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\W32Time\TimeProviders\NtpServer:Enabled]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00212
checkname:C.18.9.6.1 - Allow Microsoft accounts to be optional
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:MSAOptional
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00213
checkname:C.18.9.8.1 - Disallow Autoplay for non-volume devices
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoAutoplayfornonVolume
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00214
checkname:C.18.9.8.2 - Set the default behavior for AutoRun
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Explorer:NoAutorun
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00215
checkname:C.18.9.16.1 - Do not display the password reveal button
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_CredUI:DisablePasswordReveal
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00216
checkname:C.18.9.16.2 - Enumerate administrator accounts on elevation
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_CredUI:EnumerateAdministrators
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00217
checkname:C.18.9.25.1 - Ensure 'EMET 5.52' or higher is installed...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_CredUI:EnumerateAdministrators
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:5.52

id:microsoft_os_windows_2012.1.00218
checkname:C.18.9.25.2 - Ensure 'Default Action and Mitigation Settings' is set to 'Enabled' (plus subsettings)...
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_CredUI:EnumerateAdministrators
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00219
checkname:C.18.9.25.3 - Ensure 'Default Protections for Internet Explorer' is set to 'Enabled'
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_CredUI:EnumerateAdministrators
stanzastart:^(?!"Explorer")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00220
checkname:C.18.9.25.4 - Ensure 'Default Protections for Popular Software' is set to 'Enabled'
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_CredUI:EnumerateAdministrators
stanzastart:^(?!"Protection")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00221
checkname:C.18.9.25.5 - Ensure 'Default Protections for Recommended Software' is set to 'Enabled'
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_CredUI:EnumerateAdministrators
stanzastart:^(?!"Protection")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00222
checkname:C.18.9.25.6 - System ASLR is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\SysSettings:ASLR]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00223
checkname:C.18.9.25.7 - System DEP is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\SysSettings:DEP]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00224
checkname:C.18.9.25.8 - System SEHOP is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\EMET\SysSettings:SEHOP]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00225
checkname:C.18.9.27.1.1 - Control Event Log behavior when the log file reaches its maximum size
severity:Critical
stanzaempty:Failed
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_Setup:Retention
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00226
checkname:C.18.9.27.1.2 - Setup\Specify the maximum log file size (KB)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Setup:MaxSize
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:min:32768

id:microsoft_os_windows_2012.1.00227
checkname:C.18.9.27.2.1 - Control Event Log behavior when the log file reaches its maximum size
severity:Critical
stanzaempty:Failed
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_Setup:Retention
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00228
checkname:C.18.9.27.2.2 - Setup\Specify the maximum log file size (KB)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Setup:MaxSize
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:min:32768

id:microsoft_os_windows_2012.1.00229
checkname:C.18.9.27.3.1 - Control Event Log behavior when the log file reaches its maximum size
severity:Critical
stanzaempty:Failed
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_Setup:Retention
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00230
checkname:C.18.9.27.3.2 - Setup\Specify the maximum log file size (KB)
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Setup:MaxSize
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:min:32768

id:microsoft_os_windows_2012.1.00231
checkname:C.18.9.27.4.1 - Control Event Log behavior when the log file reaches its maximum size
severity:Critical
stanzaempty:Failed
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_Setup:Retention
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00232
checkname:C.18.9.27.4.2 - System Event Log - Specify the maximum log file size (KB).
severity:Critical
stanzaempty:Failed
conditional:ifelse::matchvalue
segment:Windows_Reg_System:MaxSize
stanzastart: ^(?!\"MachineName\")[^\;]*\;
stanzastop: $
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:min:32768
Conditions {
    if_passed {
        type: notapplicable
    }
    if_failed {
        type: matchvalue
        segment: Windows_EventLogs_Policy
        stanzastart:^(?!"MachineName")[^\;]*\;"System"
        stanzastop:$
        match:^(?:[^\;]*\;){4}"(\d+)
        criteria:min:33554432
    }
}

id:microsoft_os_windows_2012.1.00233
checkname:C.18.9.31.2 - Turn off Data Execution Prevention for Explorer
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Explorer:NoDataExecutionPrevention
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00234
checkname:C.18.9.31.3 - Turn off heap termination on corruption
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Explorer:NoHeapTerminationOnCorruption
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00235
checkname:C.18.9.31.4 - Turn off shell protocol protected mode
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Explorer:PreXPSP2ShellProtocolBehavior
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00236
checkname:C.18.9.41.1.1 - Turn off Windows Location Provider is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors:DisableWindowsLocationProvider]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00237
checkname:C.18.9.41.2 - Turn off location is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors:DisableLocation]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00238
checkname:C.18.9.47.15 - Turn off Microsoft Defender AntiVirus
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Windows Defender:DisableAntiSpyware
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00239
checkname:C.18.9.47.4.1 - Configure local setting override for reporting to Microsoft MAPS
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_Spynet:LocalSettingOverrideSpynetReporting
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00240
checkname:C.18.9.47.4.2 - Join Microsoft MAPS is set to Disabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet:SpynetReporting]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00241
checkname:C.18.9.47.9.1 - Scan all downloaded files and attachments
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_RTProtection:DisableIOAVProtection
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00242
checkname:C.18.9.47.9.2 - Turn off real-time protection
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_RTProtection:DisableRealtimeMonitoring
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00243
checkname:C.18.9.47.9.3 - Turn on behavior monitoring
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_RTProtection:DisableBehaviorMonitoring
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00244
checkname:C.18.9.47.9.4 - Turn on script scanning
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_RTProtection:DisableScriptScanning
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00245
checkname:C.18.9.47.11.1 - Configure Watson Events is set to Disabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Reporting:DisableGenericRePorts]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00246
checkname:C.18.9.47.12.1 - Scan removable drives
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Scan:DisableRemovableDriveScanning
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00247
checkname:C.18.9.47.12.2 - Turn on e-mail scanning
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Scan:DisableEmailScanning
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00248
checkname:C.18.9.58.1 - Prevent the usage of OneDrive for file storage
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_OneDrive:DisableFileSyncNGSC
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00249
checkname:C.18.9.58.2 - Prevent the usage of OneDrive for file storage on Windows 8.1 is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\OneDrive:DisableFileSync]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00250
checkname:C.18.9.65.2.2 - Remote Desktop Connection Client - Do not allow passwords to be saved
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_TS:DisablePasswordSaving
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00261
checkname:C.18.9.65.3.2.1 - Restrict RDS users to a single RDS session is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services:fSingleSessionPerUser]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00262
checkname:C.18.9.65.3.3.1 - Do not allow COM port redirection is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services:fDisableCcm]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00263
checkname:C.18.9.65.3.3.2 - Do not allow drive redirection
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Terminal Services:fDisableCdm
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00264
checkname:C.18.9.65.3.3.3 - Do not allow LPT port redirection is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services:fDisableLPT]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00265
checkname:C.18.9.65.3.3.4 - Do not allow supported Plug and Play device redirection is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services:fDisablePNPRedir]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00266
checkname:C.18.9.65.3.9.1 - Always prompt for password upon connection
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_TS:fPromptForPassword
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00267
checkname:C.18.9.65.3.9.2 - Require secure RPC communication
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_TS:fEncryptRPCTraffic
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00268
checkname:C.18.9.65.3.9.3 - Require use of specific security layer for remote (RDP) connections
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_TS:SecurityLayer
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:2

id:microsoft_os_windows_2012.1.00269
checkname:C.18.9.65.3.9.4 - Require user authentication for remote connections by using Network Level Authentication
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_TS:UserAuthentication
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00270
checkname:C.18.9.65.3.9.5 - Set client connection encryption level
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_TS:MinEncryptionLevel
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:3

id:microsoft_os_windows_2012.1.00272
checkname:C.18.9.65.3.11.1 - Do not delete temp folders upon exit
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_TS:DeleteTempDirsOnExit
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00273
checkname:C.18.9.65.3.11.2 - Do not use temporary folders per session
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_TS:PerSessionTempDir
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"1|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00274
checkname:C.18.9.66.1 - Prevent downloading of enclosures
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Feeds:DisableEnclosureDownload
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:1

id:microsoft_os_windows_2012.1.00275
checkname:C.18.9.67.2 - Allow indexing of encrypted files
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_WSearch:AllowIndexingEncryptedStoresOrItems
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00276
checkname:C.18.9.67.3 - Set what information is shared in Search is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search:ConnectedSearchPrivacy]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00277
checkname:C.18.9.85.1.1 - Configure Windows Defender SmartScreen
severity:Critical
stanzaempty:Failed
stanzaempty:Failed
type:multicheck
checks {
  rule1 {
    id:rule EnableSmartScreen
    checkname:IP.C.18.9.85.1.1.1 - Configure Windows Defender SmartScreen - EnableSmartScreen
    severity:Critical
    stanzaempty:Failed
    type:matchvalue
    segment:Windows_Reg_System:EnableSmartScreen
    stanzastart:^(?!"MachineName")[^\;]*\;
    stanzastop:$
    match:^(?:[^\;]*\;){2}"(\d+)
    criteria:equal:1
  }
  rule2 {
    id:rule ShellSmartScreenLevel
    checkname:IP.C.18.9.85.1.1.2 - Configure Windows Defender SmartScreen - ShellSmartScreenLevel
    severity:Critical
    stanzaempty:Failed
    type:match
    segment:Windows_Reg_System:ShellSmartScreenLevel
    stanzastart:^(?!"MachineName")[^\;]*\;
    stanzastop:$
    stanzacriteria:include:(?im)^(?:[^\;]*\;){2}"Block"
  }
}

id:microsoft_os_windows_2012.1.00278
checkname:C.18.9.86.3 - Automatically send memory dumps for OS-generated error reports is set to Disabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting:AutoApproveOSDumps]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^0\s*$

id:microsoft_os_windows_2012.1.00279
checkname:C.18.9.86.2.1 - Configure Default consent is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting\Consent:DefaultConsent]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00280
checkname:C.18.9.90.1 - Allow user control over installs
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Installer:EnableUserControl
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00281
checkname:C.18.9.90.2 - Always install with elevated privileges
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Installer:AlwaysInstallElevated
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00282
checkname:C.18.9.90.3 - Prevent Internet Explorer security prompt for Windows Installer scripts is set to Disabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer:SafeForScripting]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^0\s*$

id:microsoft_os_windows_2012.1.00283
checkname:C.18.9.91.1 - Sign-in and lock last interactive user automatically after a restart
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_System:DisableAutomaticRestartSignOn
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00284
checkname:C.18.9.100.1 - Turn on PowerShell Script Block Logging
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_ScriptBlockLogging:EnableScriptBlockLogging
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:0

id:microsoft_os_windows_2012.1.00285
checkname:C.19.9.100.2 - Turn on PowerShell Transcription
severity:Critical
stanzaempty:Failed
type:alwayspassed
segment:Windows_Reg_Transcription:EnableTranscripting
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)"
criteria:equal:1

id:microsoft_os_windows_2012.1.00286
checkname:C.18.9.102.1.1 - Allow Basic authentication (Client)
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Client:AllowBasic
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00287
checkname:C.18.9.102.1.2 - Allow unencrypted traffic (client)
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Client:AllowUnencryptedTraffic
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00288
checkname:C.18.9.102.1.3 - Disallow Digest authentication
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Client:AllowDigest
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00289
checkname:C.18.9.102.2.1 - Allow Basic authentication (service)
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Service:AllowBasic
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00290
checkname:C.18.9.102.2.2 - Allow remote server management through WinRM is set to Disabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service:AllowAutoConfig]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00291
checkname:C.18.9.102.2.3 - Allow unencrypted traffic (service)
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_Service:AllowUnencryptedTraffic
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00292
checkname:C.18.9.102.2.4 - Domain controller: Allow server operators to schedule tasks
severity:Critical
stanzaempty:Failed
conditional:ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment:Windows_SystemInfo
stanzastart:^(?!\"MachineName\")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){21}(?:\"\w+ Domain Controller\")
Conditions {
    if_passed {
        # Server is a domain controller therefore line must exist with specific value
        stanzaempty:Failed
        type:matchvalue
        segment:Windows_Reg_Lsa:SubmitControl
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){2}"(\d+)"
        criteria:equal:0
    }
    if_failed {
        # Server is not domain controller therefore requirement not relevant
        type:notapplicable
    }
}

id:microsoft_os_windows_2012.1.00293
checkname:C.18.9.103.1 - Allow Remote Shell Access is set to Disabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\WinRS:AllowRemoteShellAccess]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00294
checkname:C.18.9.108.1.1 - No auto-restart with logged on users for scheduled automatic updates installations
severity:Critical
stanzaempty:Failed
type:match
segment:Windows_Reg_AU:NoAutoRebootWithLoggedOnUsers
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
stanzacriteria:include:^(?:[^\;]*\;){2}"0|registry\skey\snot\sfound"

id:microsoft_os_windows_2012.1.00295
checkname:C.18.9.108.2.1 - Configure Automatic Updates
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_AU:NoAutoUpdate
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00296
checkname:C.18.9.108.2.2 - Configure Automatic Updates: Scheduled install day
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_AU:ScheduledInstallDay
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){2}"(\d+)
criteria:equal:0

id:microsoft_os_windows_2012.1.00297
checkname:C.19.1.3.1 - Enable screen saver
severity:Critical
stanzaempty:Failed
conditional: ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment: Windows_SystemInfo
stanzastart: ^(?!\"MachineName\")[^\;]*\;
stanzastop: $
stanzacriteria: include:^(?:[^\;]*\;){21}(?:\"(?!.*Standalone).*")
Conditions {
    if_passed {
        # Server is domain joined therefore key must exist
        type:alwayspassed
        segment:Windows_Reg_Users_Desktop:ScreenSaveActive
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){4}"(\d+)
        criteria:equal:1
    }
    if_failed {
	# Server is not domain joined therefore requirement not relevant
        type: alwayspassed
    }
}

id:microsoft_os_windows_2012.1.00298
checkname:C.19.1.3.2 - Password protect the screen saver
severity:Critical
stanzaempty:Failed
conditional: ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment: Windows_SystemInfo
stanzastart: ^(?!\"MachineName\")[^\;]*\;
stanzastop: $
stanzacriteria: include:^(?:[^\;]*\;){21}(?:\"(?!.*Standalone).*")
Conditions {
    if_passed {
        # Server is domain joined therefore key must exist
        type:alwayspassed
        segment:Windows_Reg_Users_Desktop:ScreenSaverIsSecure
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){4}"(\d+)
        criteria:equal:1
    }
    if_failed {
        # Server is not domain joined therefore requirement not relevant
        type: alwayspassed
    }
}

id:microsoft_os_windows_2012.1.00299
checkname:C.19.1.3.3 - Screen saver timeout
severity:Critical
stanzaempty:Failed
type:matchvalue
segment:Windows_Reg_Users_Desktop:ScreenSaveTimeOut
stanzastart:^(?!"MachineName")[^\;]*\;
stanzastop:$
match:^(?:[^\;]*\;){4}"(\d+)
criteria:range:1-900

id:microsoft_os_windows_2012.1.00300
checkname:C.19.5.1.1 - Turn off toast notifications on the lock screen
severity:Critical
stanzaempty:Failed
conditional: ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment: Windows_SystemInfo
stanzastart: ^(?!\"MachineName\")[^\;]*\;
stanzastop: $
stanzacriteria: include:^(?:[^\;]*\;){21}(?:\"(?!.*Standalone).*")
Conditions {
    if_passed {
        # Server is domain joined therefore key must exist
        type:alwayspassed
      segment:Windows_Reg_Users_PushNotifications:NoToastApplicationNotificationOnLockScreen
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){4}"(\d+)
        criteria:equal:1
    }
    if_failed {
        # Server is not domain joined therefore requirement not relevant
        type: alwayspassed
    }
}

id:microsoft_os_windows_2012.1.00301
checkname:C.19.6.6.1.1 - Turn off Help Experience Improvement Program
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_USERS\*\Software\Policies\Microsoft\Assistance\Client\1.0:NoImplicitFeedback]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$

id:microsoft_os_windows_2012.1.00302
checkname:C.19.7.4.1 - Do not preserve zone information in file attachments
severity:Critical
stanzaempty:Failed
conditional: ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment: Windows_SystemInfo
stanzastart: ^(?!\"MachineName\")[^\;]*\;
stanzastop: $
stanzacriteria: include:^(?:[^\;]*\;){21}(?:\"(?!.*Standalone).*")
Conditions {
    if_passed {
        # Server is domain joined therefore key must exist
        type:matchvalue
        segment:Windows_Reg_Users_Attachments:SaveZoneInformation
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){4}"(\d+)
        criteria:equal:2
    }
    if_failed {
        # Server is not domain joined therefore requirement not relevant
        type: notapplicable
    }
}

id:microsoft_os_windows_2012.1.00303
checkname:C.19.7.4.2 - Notify antivirus programs when opening attachments
severity:Critical
stanzaempty:Failed
conditional: ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment: Windows_SystemInfo
stanzastart: ^(?!\"MachineName\")[^\;]*\;
stanzastop: $
stanzacriteria: include:^(?:[^\;]*\;){21}(?:\"(?!.*Standalone).*")
Conditions {
    if_passed {
        # Server is domain joined therefore key must exist
        type:matchvalue
        segment:Windows_Reg_Users_Attachments:ScanWithAntiVirus
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){4}"(\d+)
        criteria:equal:3
    }
    if_failed {
        # Server is not domain joined therefore requirement not relevant
        type: notapplicable
    }
}

id:microsoft_os_windows_2012.1.00304
checkname:C.19.7.28.1 - Prevent users from sharing files within their profile
severity:Critical
stanzaempty:Failed
conditional: ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment: Windows_SystemInfo
stanzastart: ^(?!\"MachineName\")[^\;]*\;
stanzastop: $
stanzacriteria: include:^(?:[^\;]*\;){21}(?:\"(?!.*Standalone).*")
Conditions {
    if_passed {
        # Server is domain joined therefore key must exist
        type:alwayspassed
        segment:Windows_Reg_Users_Explorer:NoInplaceSharing
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){4}"(\d+)
        criteria:equal:1
    }
    if_failed {
        # Server is not domain joined therefore requirement not relevant
        type: alwayspassed
    }
}

id:microsoft_os_windows_2012.1.00305
checkname:C.19.7.43.1 - Always install with elevated privileges
severity:Critical
stanzaempty:Failed
conditional: ifelse::match
# Check for server domain role
# Valid roles are: ("Standalone Workstation","Member Workstation","Standalone Server","Member Server","Backup Domain Controller","Primary Domain Controller")
segment: Windows_SystemInfo
stanzastart: ^(?!\"MachineName\")[^\;]*\;
stanzastop: $
stanzacriteria: include:^(?:[^\;]*\;){21}(?:\"(?!.*Standalone).*")
Conditions {
    if_passed {
        # Server is domain joined therefore key must exist
        type:alwayspassed
        segment:Windows_Reg_Users_Installer:AlwaysInstallElevated
        stanzastart:^(?!"MachineName")[^\;]*\;
        stanzastop:$
        match:^(?:[^\;]*\;){4}"(\d+)
        criteria:equal:0
    }
    if_failed {
        # Server is not domain joined therefore requirement not relevant
        type: alwayspassed
    }
}

id:microsoft_os_windows_2012.1.00306
checkname:C.19.7.47.2.1 - Prevent Codec Download is set to Enabled
severity: critical
stanzaempty: Failed
type: match
segment: [HKEY_USERS\*\Software\Policies\Microsoft\WindowsMediaPlayer:PreventCodecDownload]
stanzastart:^\S+
stanzastop: $
stanzacriteria: include:^1\s*$
